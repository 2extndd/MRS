# üéØ TODO: PROXY SYSTEM & BUG FIXES

## üìã –ê–ù–ê–õ–ò–ó –¢–ï–ö–£–©–ï–ô –°–ò–¢–£–ê–¶–ò–ò

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- Items –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ë–î (103 items)
- get_item() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ item
- Image proxy endpoint —Å–æ–∑–¥–∞–Ω

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã:
1. **–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç "0 new" –Ω–æ items –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è** - –±–∞–≥ –≤ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ü–∏–∫–ª –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** - worker –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç
3. **–ü—Ä–æ–∫—Å–∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –Ω—É–∂–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—è 100+ –ø—Ä–æ–∫—Å–∏

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–¥–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è "Found X items (Y new)"
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ new_items –≤ _process_new_items
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏ —á—Ç–æ–±—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ —Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ü–∏–∫–ª–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å simple_telegram_worker.py - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–∏ loop?
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ deadlock/infinite wait
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏ "Starting automatic cycle"

### 3. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∫—Å–∏ —Å–∏—Å—Ç–µ–º—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å proxies.py - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏?
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ–∫—Å–∏: ip:port:user:pass
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å mercapi/pyMercariAPI

---

## üõ†Ô∏è –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –ü–†–û–ö–°–ò

### –§–æ—Ä–º–∞—Ç –ø—Ä–æ–∫—Å–∏: `82.21.62.51:7815:wtllhdak:9vxcxlvhxv1h`
- IP:PORT:USERNAME:PASSWORD
- 100+ –ø—Ä–æ–∫—Å–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (–∫–∞–∫ –≤ vintedsearcher)

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–æ—Ç–∞—Ü–∏–∏:
1. **Round-robin** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
2. **Fallback –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π** –µ—Å–ª–∏ 403/timeout
3. **Blacklist** –Ω–∞ 5 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ 3 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
4. **Proxy pool** –≤ shared_state –¥–ª—è cross-process

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
1. **proxies.py** - ProxyRotator class
   - load_proxies() - –∏–∑ config
   - get_next() - round-robin
   - mark_failed() - blacklist logic
   - get_working_count() - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

2. **pyMercariAPI/mercari.py**
   - –î–æ–±–∞–≤–∏—Ç—å proxy –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ search()
   - –î–æ–±–∞–≤–∏—Ç—å proxy –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ get_item()
   - Retry —Å –Ω–æ–≤—ã–º proxy –ø—Ä–∏ –æ—à–∏–±–∫–µ

3. **core.py**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ProxyRotator
   - –ü–µ—Ä–µ–¥–∞—á–∞ proxy –≤ api.search()
   - –°–º–µ–Ω–∞ proxy –ø—Ä–∏ 403/429

4. **Web UI**
   - –¢–µ—Å—Ç –ø—Ä–æ–∫—Å–∏ endpoint (—É–∂–µ –µ—Å—Ç—å)
   - –ü–æ–∫–∞–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–∫—Å–∏
   - –ö–æ–Ω—Ñ–∏–≥ –ø—Ä–æ–∫—Å–∏ (—É–∂–µ –µ—Å—Ç—å)

---

## üìù TODO LIST

### PHASE 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (3 tasks)
- [ ] 1.1 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ "Found X (Y new)" - –Ω–∞–π—Ç–∏ –±–∞–≥
- [ ] 1.2 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å worker automatic cycle - –ø–æ—á–µ–º—É –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- [ ] 1.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø—Ä–æ–∫—Å–∏ —Å–∏—Å—Ç–µ–º—É - —á—Ç–æ —É–∂–µ –µ—Å—Ç—å

### PHASE 2: –§–∏–∫—Å –±–∞–≥–æ–≤ (2 tasks)
- [ ] 2.1 –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ new items count
- [ ] 2.2 –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ü–∏–∫–ª worker

### PHASE 3: –ü—Ä–æ–∫—Å–∏ —Å–∏—Å—Ç–µ–º–∞ (5 tasks)
- [ ] 3.1 –û–±–Ω–æ–≤–∏—Ç—å proxies.py - ProxyRotator class —Å —Ñ–æ—Ä–º–∞—Ç–æ–º ip:port:user:pass
- [ ] 3.2 –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ pyMercariAPI/mercari.py - proxy –ø–∞—Ä–∞–º–µ—Ç—Ä
- [ ] 3.3 –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ core.py - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ProxyRotator
- [ ] 3.4 –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∫—Å–∏ –≤ shared_state
- [ ] 3.5 –û–±–Ω–æ–≤–∏—Ç—å Web UI –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø—Ä–æ–∫—Å–∏ stats

### PHASE 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (3 tasks)
- [ ] 4.1 –¢–µ—Å—Ç proxy rotation - –º–µ–Ω—è—é—Ç—Å—è –ª–∏ –ø—Ä–æ–∫—Å–∏
- [ ] 4.2 –¢–µ—Å—Ç fallback - —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- [ ] 4.3 –¢–µ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ü–∏–∫–ª–∞ - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–∏ –∫–∞–∂–¥—ã–µ 60s

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ new items
- ‚úÖ Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
- ‚úÖ 100+ –ø—Ä–æ–∫—Å–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ Fallback –Ω–∞ –Ω–æ–≤—ã–π –ø—Ä–æ–∫—Å–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∫—Å–∏ –≤ Web UI
- ‚úÖ Bypass Mercari rate limits —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏

