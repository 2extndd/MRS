# üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: PostgreSQL Authentication Failed

## –ß–¢–û –°–õ–û–ú–ê–ù–û

```
[DB ERROR] Failed to connect: password authentication failed for user "postgres"
```

**DATABASE_URL —Å–æ–¥–µ—Ä–∂–∏—Ç –°–¢–ê–†–´–ô –ü–ê–†–û–õ–¨ –æ—Ç –£–î–ê–õ–ï–ù–ù–û–ô –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö!**

### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:

‚ùå **Web service:** Fallback –Ω–∞ in-memory SQLite
‚ùå **Queries:** –î–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ RAM ‚Üí –∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
‚ùå **Config:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ RAM ‚Üí –ø—Ä–æ–ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
‚ùå **Worker:** –ß–∏—Ç–∞–µ—Ç –∏–∑ PostgreSQL (–ø—É—Å—Ç–æ–π) ‚Üí "Found 0 searches"
‚ùå **Hot reload:** –†–∞–±–æ—Ç–∞–µ—Ç –Ω–æ —á–∏—Ç–∞–µ—Ç –ø—É—Å—Ç—É—é —Ç–∞–±–ª–∏—Ü—É

---

## –†–ï–®–ï–ù–ò–ï: –°–æ–∑–¥–∞—Ç—å –ù–û–í–£–Æ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

### ‚úÖ –í–ê–†–ò–ê–ù–¢ 1: Railway Dashboard (–°–ê–ú–´–ô –ü–†–û–°–¢–û–ô!)

1. **–û—Ç–∫—Ä–æ–π:** https://railway.app/project/f17da572-14c9-47b5-a9f1-1b6d5b6dea2d

2. **–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "+ New"** (–ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª)

3. **–í—ã–±–µ—Ä–∏:**
   - **"Database"**
   - **"Add PostgreSQL"**

4. **Railway –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò:**
   - ‚úÖ –°–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
   - ‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π DATABASE_URL —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç DATABASE_URL –≤ —Å–µ—Ä–≤–∏—Å—ã `web` –∏ `worker`
   - ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç auto-redeploy –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

5. **–ü–æ–¥–æ–∂–¥–∏ 2-3 –º–∏–Ω—É—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è**

6. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:**
   ```
   railway service web && railway logs | grep "DB"
   ```

   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   ```
   [DB] Connected to PostgreSQL ‚úÖ
   ```

   –í–º–µ—Å—Ç–æ:
   ```
   [DB ERROR] Failed to connect: password authentication failed
   [DB] Using in-memory SQLite as fallback
   ```

---

### ‚úÖ –í–ê–†–ò–ê–ù–¢ 2: Railway API (–µ—Å–ª–∏ –µ—Å—Ç—å token)

–ï—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å RAILWAY_TOKEN:

1. **–ü–æ–ª—É—á–∏ —Ç–æ–∫–µ–Ω:**
   - https://railway.app/account/tokens
   - Create new token
   - –°–∫–æ–ø–∏—Ä—É–π —Ç–æ–∫–µ–Ω

2. **–ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:**
   ```bash
   export RAILWAY_TOKEN='—Ç–≤–æ–π-—Ç–æ–∫–µ–Ω-–∑–¥–µ—Å—å'
   ./create_postgres_api.sh
   ```

3. **–ü–æ–¥–æ–∂–¥–∏ 2-3 –º–∏–Ω—É—Ç—ã**

4. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏** (—Å–º. –≤—ã—à–µ)

---

## –ü–û–°–õ–ï –§–ò–ö–°–ê

### ‚úÖ –ß—Ç–æ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **Web service:** –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ PostgreSQL
2. **Queries:** –ë—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
3. **Queries:** –ù–ï –∏—Å—á–µ–∑–Ω—É—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
4. **Config:** –ë—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ PostgreSQL
5. **Config:** Hot reload –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ë–ï–ó restart
6. **Worker:** –ù–∞–π–¥–µ—Ç queries –∏ –Ω–∞—á–Ω–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å
7. **Worker:** –ë—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –≤–µ—â–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ Telegram

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
# –õ–æ–≥–∏ web
railway service web && railway logs | grep -E "(DB|Connected)"

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# [DB] Connected to PostgreSQL

# –õ–æ–≥–∏ worker
railway service worker && railway logs | tail -20

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# [STARTUP] Active searches: 1
# [STARTUP]    - Y-3 Clothing & Shoes (ID: 1)

# API —Ç–µ—Å—Ç
curl https://web-production-fe38.up.railway.app/api/queries

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# {"queries": [...], "success": true}
# –ù–ï –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫!
```

---

## –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û: –î–æ–±–∞–≤–∏—Ç—å query –ø–æ—Å–ª–µ —Ñ–∏–∫—Å–∞

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
python3 add_query_to_railway.py
```

–≠—Ç–æ –¥–æ–±–∞–≤–∏—Ç:
- Keyword: Y-3
- URL: https://jp.mercari.com/search?keyword=Y-3
- Chat ID: -4997297083
- Scan interval: 300s

---

## TIMELINE

1. **–°–µ–π—á–∞—Å:** PASSWORD AUTHENTICATION FAILED
2. **–î–æ–±–∞–≤–∏—Ç—å PostgreSQL:** 30 —Å–µ–∫—É–Ω–¥ (—á–µ—Ä–µ–∑ Dashboard)
3. **Railway auto-redeploy:** 2-3 –º–∏–Ω—É—Ç—ã
4. **–î–æ–±–∞–≤–∏—Ç—å query:** 10 —Å–µ–∫—É–Ω–¥
5. **Worker –Ω–∞—á–Ω–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å:** —á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É
6. **–ü–µ—Ä–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Telegram:** —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç

---

## –ü–û–ß–ï–ú–£ –≠–¢–û –°–õ–£–ß–ò–õ–û–°–¨

–¢—ã **–£–î–ê–õ–ò–õ** —Å—Ç–∞—Ä—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—à–ª–æ–π —Å–µ—Å—Å–∏–∏, –Ω–æ **DATABASE_URL** –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤—Å–µ –µ—â–µ —É–∫–∞–∑—ã–≤–∞–ª –Ω–∞ –Ω–µ–µ —Å —Å—Ç–∞—Ä—ã–º –ø–∞—Ä–æ–ª–µ–º!

Railway –ù–ï –æ–±–Ω–æ–≤–∏–ª DATABASE_URL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è.

–ü–æ—ç—Ç–æ–º—É:
- –ö–æ–¥ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑–µ
- PostgreSQL –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å)
- –°–∏—Å—Ç–µ–º–∞ fallback –Ω–∞ SQLite in-memory
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ RAM –∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ

---

## IMPORTANT

**–ù–ï –ó–ê–ë–£–î–¨:**

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –Ω—É–∂–Ω–æ **–ü–†–û–í–ï–†–ò–¢–¨** —á—Ç–æ DATABASE_URL –æ–±–Ω–æ–≤–∏–ª—Å—è:

```bash
railway service web && railway variables | grep DATABASE_URL
```

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å **–ù–û–í–´–ô** URL —Å **–ù–û–í–´–ú** –ø–∞—Ä–æ–ª–µ–º!

–ï—Å–ª–∏ URL –≤—Å–µ –µ—â–µ **–°–¢–ê–†–´–ô**, –Ω—É–∂–Ω–æ **–í–†–£–ß–ù–£–Æ** —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π DATABASE_URL:
```bash
railway service web
railway variables --unset DATABASE_URL
```

–ó–∞—Ç–µ–º Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç –Ω–æ–≤—ã–π DATABASE_URL –æ—Ç –Ω–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

---

**–î–ï–õ–ê–ô –°–ï–ô–ß–ê–°!** üöÄ
