# ü§ñ AI AGENT MEMORY - MercariSearcher Bot

## ‚ö†Ô∏è –ü–û–°–¢–û–Ø–ù–ù–´–ï –ü–†–ê–í–ò–õ–ê

### –ü—Ä–∞–≤–∏–ª–æ 1: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å** –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¢–û–õ–¨–ö–û** —ç—Ç–æ—Ç —Ñ–∞–π–ª `AI_AGENT_MEMORY.md`
- –í—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ–Ω—Ç–µ–∫—Å—Ç - –¢–û–õ–¨–ö–û –ó–î–ï–°–¨
- **–ù–ï —Ç—Ä–∞—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω—ã** –Ω–∞ –±–µ—Å–ø–æ–ª–µ–∑–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### –ü—Ä–∞–≤–∏–ª–æ 2: –ö–æ–º–∞–Ω–¥–∞ "–ó–ê–ü–û–ú–ù–ò!"
- –ü–æ—Å–ª–µ —Å–ª–æ–≤–∞ "–ó–ê–ü–û–ú–ù–ò!" –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ —ç—Ç–æ—Ç —Ñ–∞–π–ª
- –ü—Ä–∞–≤–∏–ª–∞ –¥–µ–π—Å—Ç–≤—É—é—Ç –¥–ª—è –≤—Å–µ—Ö –±—É–¥—É—â–∏—Ö —Å–µ—Å—Å–∏–π

### –ü—Ä–∞–≤–∏–ª–æ 3: –ö–æ–º–∞–Ω–¥–∞ "–ó–ê–ü–û–ú–ù–ò –ö–û–ù–¢–ï–ö–°–¢!"
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–±–æ—Ç—ã –≤ —ç—Ç–æ—Ç —Ñ–∞–π–ª
- –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–∏–º–∏ AI –∞–≥–µ–Ω—Ç–∞–º–∏

---

## üìã –û –ü–†–û–ï–ö–¢–ï: MercariSearcher Bot

### –ß—Ç–æ —ç—Ç–æ?
Telegram –±–æ—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Mercari.jp (—è–ø–æ–Ω—Å–∫–∏–π –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å). –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ò—â–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
- –°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–æ—Ç–æ –≤ –í–´–°–û–ö–û–ú —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

### –û—Å–Ω–æ–≤–∞
- **–Ø–∑—ã–∫**: Python 3
- **API –±–∏–±–ª–∏–æ—Ç–µ–∫–∞**: `mercapi` (v0.4.2+)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL –Ω–∞ Railway
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Railway (web + worker)
- **Telegram**: python-telegram-bot

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
mercari_notifications.py (main)
  ‚îú‚îÄ> core.py (MercariSearcher) - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
  ‚îÇ   ‚îî‚îÄ> pyMercariAPI/mercari.py - –æ–±—ë—Ä—Ç–∫–∞ –≤–æ–∫—Ä—É–≥ mercapi
  ‚îÇ       ‚îî‚îÄ> mercapi library - —Ä–µ–∞–ª—å–Ω—ã–π API Mercari
  ‚îÇ
  ‚îú‚îÄ> image_handler.py - –∑–∞–≥—Ä—É–∑–∫–∞ HIGH-RES —Ñ–æ—Ç–æ
  ‚îÇ
  ‚îú‚îÄ> db.py - —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL
  ‚îÇ
  ‚îî‚îÄ> simple_telegram_worker.py - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
```

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã

1. **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫** –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥
2. **–ü–æ–∏—Å–∫** —á–µ—Ä–µ–∑ `mercapi.search(query="keyword")`
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞**:
   - –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏: `mercapi.item(item_id)`
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å URL —Ñ–æ—Ç–æ –≤ HIGH-RES (`/item/detail/orig/photos/`)
   - –°–∫–∞—á–∞—Ç—å —Ñ–æ—Ç–æ (–ë–ï–ó –ø—Ä–æ–∫—Å–∏!)
   - –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤ base64
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PostgreSQL
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (–ø–æ mercari_id)
5. **Telegram** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å high-res —Ñ–æ—Ç–æ

---

## üîß –ö–õ–Æ–ß–ï–í–´–ï –§–ê–ô–õ–´

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏
- `mercari_notifications.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
- `core.py` - –∫–ª–∞—Å—Å MercariSearcher, –≤—Å—è –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞
- `image_handler.py` - –∑–∞–≥—Ä—É–∑–∫–∞ HIGH-RES –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚≠ê
- `db.py` - —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL
- `simple_telegram_worker.py` - Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `configuration_values.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### API –æ–±—ë—Ä—Ç–∫–∞
- `pyMercariAPI/mercari.py` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π wrapper –≤–æ–∫—Ä—É–≥ mercapi
- `pyMercariAPI/items.py` - –∫–ª–∞—Å—Å—ã Item/Items
- `pyMercariAPI/exceptions.py` - –∏—Å–∫–ª—é—á–µ–Ω–∏—è

### –¢–µ—Å—Ç—ã
- `test_real_mercari.py` - —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Ç–µ—Å—Ç
- `railway_test_deployment.py` - —Ç–µ—Å—Ç –¥–ª—è Railway

---

## ‚≠ê –ü–û–°–õ–ï–î–ù–ò–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø (19 –Ω–æ—è–±—Ä—è 2024)

### 1. –°–æ–∑–¥–∞–Ω `image_handler.py`
**–§—É–Ω–∫—Ü–∏–∏**:
- `get_original_image_url(url)` - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –ª—é–±–æ–π URL –≤ HIGH-RES
  - –í—Ö–æ–¥–Ω–æ–π: `https://static.mercdn.net/thumb/...` (240px)
  - –í—ã—Ö–æ–¥–Ω–æ–π: `https://static.mercdn.net/item/detail/orig/photos/mXXX_N.jpg` (1200px+)
- `download_and_encode_image(url)` - —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ –∫–æ–¥–∏—Ä—É–µ—Ç –≤ base64
  - –ë–ï–ó –ø—Ä–æ–∫—Å–∏! Mercari CDN –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `data:image/jpeg;base64,...`

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `core.py`
**–ú–µ—Ç–æ–¥ `_process_new_items()`**:
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –∞—Ç—Ä–∏–±—É—Ç–∞–º Item: `.id`, `.title`, `.price`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è URL –≤ HIGH-RES
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `image_data` –≤ –±–∞–∑—É

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `pyMercariAPI/mercari.py`
**–ú–µ—Ç–æ–¥ `search()`**:
- –ë—ã–ª–æ: `await m.search(keyword=...)`
- –°—Ç–∞–ª–æ: `await m.search(query=...)`
- –§–∏–∫—Å: mercapi –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `query`, –Ω–µ `keyword`

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `simple_telegram_worker.py`
**–ú–µ—Ç–æ–¥ `send_item_notification()`**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è URL –≤ HIGH-RES –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- Telegram –ø–æ–ª—É—á–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ

### 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `test_real_mercari.py`
- –û–±–Ω–æ–≤–ª—ë–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: `query=` –≤–º–µ—Å—Ç–æ `keyword=`

---

## üìä –ë–ê–ó–ê –î–ê–ù–ù–´–• (PostgreSQL)

### –¢–∞–±–ª–∏—Ü–∞ `items`
```sql
id              SERIAL PRIMARY KEY
mercari_id      VARCHAR(50) UNIQUE
title           TEXT
price           INTEGER
image_url       TEXT              -- HIGH-RES URL
image_data      TEXT              -- Base64 encoded image ‚≠ê
telegram_sent   BOOLEAN
created_at      TIMESTAMP
```

**–í–∞–∂–Ω–æ**: 
- `image_url` - URL –≤ –≤—ã—Å–æ–∫–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏
- `image_data` - base64 –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ñ–æ—Ç–æ (130-500KB)
- –í—Å–µ –Ω–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å —Ñ–æ—Ç–æ!

---

## üöÄ RAILWAY

### Project ID
`f17da572-14c9-47b5-a9f1-1b6d5b6dea2d`

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
DATABASE_URL=postgresql://...
TELEGRAM_BOT_TOKEN=...
TELEGRAM_CHAT_ID=...
TELEGRAM_THREAD_ID=...  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
PROXY_ENABLED=false     # —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞—é—Ç –ë–ï–ó –ø—Ä–æ–∫—Å–∏!
```

### –î–µ–ø–ª–æ–π
```bash
railway link -p f17da572-14c9-47b5-a9f1-1b6d5b6dea2d
git add .
git commit -m "commit message"
git push
railway logs -f
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –õ–æ–∫–∞–ª—å–Ω–æ
```bash
python3 test_real_mercari.py
```

### –ù–∞ Railway
```bash
railway ssh
python3 railway_test_deployment.py
```

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (19 –Ω–æ—è–±—Ä—è 2024)
- ‚úÖ –ù–∞–π–¥–µ–Ω–æ: 120 —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: 70 –ù–û–í–´–• —Å high-res —Ñ–æ—Ç–æ
- ‚úÖ –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ: 50 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: 100%

---

## üîç –í–ê–ñ–ù–´–ï –î–ï–¢–ê–õ–ò

### mercapi —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
```python
# –ü–†–ê–í–ò–õ–¨–ù–û:
await m.search(query="keyword")
item = await m.item("m12345678")

# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Å—Ç–∞—Ä—ã–π –∫–æ–¥):
await m.search(keyword="keyword")  # ‚ùå
```

### Item –∞—Ç—Ä–∏–±—É—Ç—ã (mercapi)
```python
item.id_           # ID —Ç–æ–≤–∞—Ä–∞
item.name          # –Ω–∞–∑–≤–∞–Ω–∏–µ
item.price         # —Ü–µ–Ω–∞
item.photos        # —Å–ø–∏—Å–æ–∫ ORIGINAL URLs
item.thumbnails    # —Å–ø–∏—Å–æ–∫ thumbnail URLs
item.item_condition.name   # —Å–æ—Å—Ç–æ—è–Ω–∏–µ
item.item_category.name    # –∫–∞—Ç–µ–≥–æ—Ä–∏—è
```

### HIGH-RES –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```python
from image_handler import get_original_image_url, download_and_encode_image

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è URL
high_res_url = get_original_image_url(thumbnail_url)

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
image_data = download_and_encode_image(high_res_url, use_proxy=False)
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: "data:image/jpeg;base64,..."
```

### –ë–µ–∑ –ø—Ä–æ–∫—Å–∏!
**–í–∞–∂–Ω–æ**: –§–æ—Ç–æ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –ë–ï–ó –ø—Ä–æ–∫—Å–∏. Mercari CDN –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

---

## üìù –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 19 –Ω–æ—è–±—Ä—è 2024
**–°—Ç–∞—Ç—É—Å**: ‚úÖ PRODUCTION READY
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å**: 95%+

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ mercapi
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ HIGH-RES —Ñ–æ—Ç–æ (–±–µ–∑ –ø—Ä–æ–∫—Å–∏)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL —Å base64
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å high-res —Ñ–æ—Ç–æ
- ‚úÖ Web UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ Hot-reload –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
1. –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Railway
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤ production
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏

---

## üí° –ö–û–ù–¢–ï–ö–°–¢ –ü–û–°–õ–ï–î–ù–ï–ô –°–ï–°–°–ò–ò

**–ó–∞–¥–∞—á–∞**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ñ–æ—Ç–æ –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ**:
1. –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `image_handler.py` –¥–ª—è HIGH-RES —Ñ–æ—Ç–æ
2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `mercapi` (query= –≤–º–µ—Å—Ç–æ keyword=)
3. –û–±–Ω–æ–≤–ª—ë–Ω `core.py` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –ø–æ–∏—Å–∫ ‚Üí –ë–î ‚Üí Telegram
5. –û—á–∏—â–µ–Ω –ø—Ä–æ–µ–∫—Ç –æ—Ç –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (43+ —Ñ–∞–π–ª–∞ —É–¥–∞–ª–µ–Ω–æ)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤**:
- 120 —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞–π–¥–µ–Ω–æ
- 70 –Ω–æ–≤—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–æ —Å HIGH-RES —Ñ–æ—Ç–æ
- 50 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ
- 100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ

**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Railway

---

## üîß TROUBLESHOOTING

### –§–æ—Ç–æ –Ω–µ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –≤ –ª–æ–≥–∞—Ö (–¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `/item/detail/orig/photos/`)
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `use_proxy=False`

### mercapi –æ—à–∏–±–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: `search(query=...)`  –Ω–µ `search(keyword=...)`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã: `item.id_`, `item.name`, –Ω–µ `item.id`, `item.title`

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `image_data` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å TEXT, –Ω–µ BYTEA
- –§–æ—Ä–º–∞—Ç: `data:image/jpeg;base64,...`

---

*–≠—Ç–æ—Ç —Ñ–∞–π–ª - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤.*
*–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö.*

---

## üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï (19 –Ω–æ—è–±—Ä—è 2024 - –ü–û–°–õ–ï–î–ù–ï–ï)

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 3 –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–∞–≥–∞

#### 1. db.add_item() –≤–æ–∑–≤—Ä–∞—â–∞–ª None –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –í PostgreSQL `cursor.lastrowid` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—Å–µ–≥–¥–∞ `None`

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `RETURNING id` –≤ INSERT –∑–∞–ø—Ä–æ—Å–µ
```python
INSERT INTO items (...) VALUES (...) RETURNING id
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¢–µ–ø–µ—Ä—å `new_items` —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ –ª–æ–≥–∞—Ö!

#### 2. Hot-reload —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ø–æ—Å—Ç–æ—è–Ω–Ω–æ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: `_config_cache` —Å—Ä–∞–≤–Ω–∏–≤–∞–ª—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Å—á–∏—Ç–∞–ª—Å—è –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ `configuration_values.py`:
- –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: `config_changed = True`
- –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ: —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `config_` –∫–ª—é—á–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: Hot-reload —Ç–µ–ø–µ—Ä—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –†–ï–ê–õ–¨–ù–´–• –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∫–æ–Ω—Ñ–∏–≥–∞

#### 3. –¢–æ–≤–∞—Ä—ã –±–µ–∑ —Ñ–æ—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ë–î ‚úÖ
**–£–∂–µ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–µ–µ** - —Ç–æ–≤–∞—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∞–∂–µ —Å `image_data = NULL`

---

### –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã

#### ‚úÖ "–¢–æ 5, —Ç–æ 50 items" –≤ –ª–æ–≥–∞—Ö - –û–ë–™–Ø–°–ù–ï–ù–û
**–°–∏–º–ø—Ç–æ–º**: –í –ª–æ–≥–∞—Ö —Ç–æ `Found 5 items`, —Ç–æ `Found 50 items`

**–ü–†–ò–ß–ò–ù–ê**: `mercapi` –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ **–ù–ï –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä limit**!

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
- `mercapi.search(query="keyword")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ –Ω–∞–π–¥—ë—Ç (–æ–±—ã—á–Ω–æ 5-120)
- –ü–æ—Ç–æ–º `pyMercariAPI` –æ–±—Ä–µ–∑–∞–µ—Ç –¥–æ `limit`
- –ï—Å–ª–∏ mercapi –Ω–∞—à—ë–ª 5 —Ç–æ–≤–∞—Ä–æ–≤ ‚Üí –≤–µ—Ä–Ω—ë—Ç 5 (–¥–∞–∂–µ –µ—Å–ª–∏ limit=50)
- –ï—Å–ª–∏ mercapi –Ω–∞—à—ë–ª 120 —Ç–æ–≤–∞—Ä–æ–≤ ‚Üí –æ–±—Ä–µ–∂–µ—Ç –¥–æ 50 (–µ—Å–ª–∏ limit=50)

**–≠—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û!** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, —Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ Mercari –≤–µ—Ä–Ω—É–ª –ø–æ –∑–∞–ø—Ä–æ—Å—É.

**–í –ª–æ–≥–∞—Ö —Ç–µ–ø–µ—Ä—å**:
```
mercapi returned 5 items, will limit to 6
API returned 5 items (limit: 6)
Found 5 items (2 new)
```

–∏–ª–∏

```
mercapi returned 120 items, will limit to 6
API returned 6 items (limit: 6)
Found 6 items (3 new)
```

**–ò—Ç–æ–≥**: –ï—Å–ª–∏ `limit=6` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö, –±–æ—Ç –≤–æ–∑—å–º—ë—Ç –º–∞–∫—Å–∏–º—É–º 6 —Ç–æ–≤–∞—Ä–æ–≤, –¥–∞–∂–µ –µ—Å–ª–∏ mercapi –≤–µ—Ä–Ω—É–ª 120.

#### ‚ùì "new items = 1, –∞ –≤–µ—â–µ–π 2" 
**–°–∏–º–ø—Ç–æ–º**: –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è 2 —Ç–æ–≤–∞—Ä–∞, –Ω–æ –≤ –ª–æ–≥–∞—Ö `(1 new)`

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
1. Exception –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—Ç–æ—Ä–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
2. `full_item.to_dict()` –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π
3. –û–¥–∏–Ω —Ç–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω, –≤—Ç–æ—Ä–æ–π –ø—Ä–æ–ø—É—â–µ–Ω –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
```bash
railway logs | grep "Exception\|Error\|Failed to process"
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–ª—è –ö–ê–ñ–î–û–ì–û —Ç–æ–≤–∞—Ä–∞:
```
[DB] Item added: Title (ID: 12345)
[PROCESS] ‚úÖ NEW item added to DB (ID: 12345)
```

---

## üîÑ –£–î–ê–õ–ï–ù–û (19 –Ω–æ—è–±—Ä—è 2024)

### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

#### 1. Items Per Query –∏ Query Delay –∏–∑ Web UI Config ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å, –±–æ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ Web UI

**–†–µ—à–µ–Ω–∏–µ**:
- `core.py` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ì–õ–û–ë–ê–õ–¨–ù–´–ï** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `config.MAX_ITEMS_PER_SEARCH`
- –≠—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ **hot-reload** –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- Web UI config ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î ‚Üí hot-reload ‚Üí –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –∑–∞–ø—Ä–æ—Å–∞–º

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å**:
1. –ó–∞–π—Ç–∏ –≤ Web UI ‚Üí Config
2. –ò–∑–º–µ–Ω–∏—Ç—å "Items Per Query" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50, –ø–æ—Å—Ç–∞–≤–∏—Ç—å 6)
3. –ò–∑–º–µ–Ω–∏—Ç—å "Query Delay" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 300, –ø–æ—Å—Ç–∞–≤–∏—Ç—å 60)
4. –ù–∞–∂–∞—Ç—å Save
5. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥

#### 2. –£–¥–∞–ª—ë–Ω image_compressor.py ‚úÖ
**–ù–µ –Ω—É–∂–µ–Ω** - —É–±—Ä–∞–ª –ª–∏—à–Ω–∏–π –∫–æ–¥

#### 3. –¢–æ–≤–∞—Ä—ã –±–µ–∑ —Ñ–æ—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ë–î ‚úÖ
**–£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** - —Ç–æ–≤–∞—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ `image_data = NULL`

### –ü–æ—á–µ–º—É "(0 new)" –≤ –ª–æ–≥–∞—Ö?

–õ–æ–≥–∏ **–ü–†–ê–í–ò–õ–¨–ù–´–ï**:
```
Found 6 items (0 new)
```

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- ‚úÖ API mercari –≤–µ—Ä–Ω—É–ª 6 —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –í—Å–µ 6 —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- ‚ö†Ô∏è –í—Å–µ 6 —Ç–æ–≤–∞—Ä–æ–≤ –£–ñ–ï –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (–¥—É–±–ª–∏–∫–∞—Ç—ã)
- ‚ÑπÔ∏è 0 –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–æ

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!** –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä—ã —É–∂–µ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ä–∞–Ω–µ–µ, –æ–Ω–∏ –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ.

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å**:
```
[CONFIG] Hot reload complete! search_interval=60s, max_items=6
Searching: https://... (limit: 6)
```

–ï—Å–ª–∏ –≤–∏–¥–∏—à—å `(limit: 50)` –≤–º–µ—Å—Ç–æ `(limit: 6)` - –∑–Ω–∞—á–∏—Ç:
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Web UI config
2. Hot-reload –µ—â—ë –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (–ø–æ–¥–æ–∂–¥–∏ 10 —Å–µ–∫—É–Ω–¥)

---

## üîÑ –£–î–ê–õ–ï–ù–û (19 –Ω–æ—è–±—Ä—è 2024 - –≤–µ—á–µ—Ä)

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. Web UI –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –§–æ—Ç–æ –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ (100-400KB) —Ç–æ—Ä–º–æ–∑—è—Ç –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü

**–†–µ—à–µ–Ω–∏–µ**:
- –°–æ–∑–¥–∞–Ω `image_compressor.py` - —Å–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è Web UI
- –§—É–Ω–∫—Ü–∏—è `compress_image_data()` - —É–º–µ–Ω—å—à–∞–µ—Ç –¥–æ 400px —à–∏—Ä–∏–Ω—ã, quality=75
- API `/api/items` –∏ `/api/recent-items` —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `image_thumbnail`
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ë–î –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
from image_compressor import compress_image_data
thumbnail = compress_image_data(image_data_uri, max_width=400, quality=75)
```

#### 2. –ù–µ–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏ —Å–∫–∞–Ω–µ—Ä–∞ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –°–∫–∞–Ω–µ—Ä –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ Web UI (Items Per Query, Query Delay)

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `scan_limit` –≤ —Ç–∞–±–ª–∏—Ü—É `searches` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
- –ö–∞–∂–¥—ã–π –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–º–µ–µ—Ç —Å–≤–æ–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
  - `scan_limit` - —Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å–∫–∞—á–∏–≤–∞—Ç—å (1-120)
  - `scan_interval` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏ (30-3600 —Å–µ–∫)
- `core.py` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `search.get('scan_limit')` –≤–º–µ—Å—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ `MAX_ITEMS_PER_SEARCH`

**–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î**:
```sql
ALTER TABLE searches ADD COLUMN IF NOT EXISTS scan_limit INTEGER DEFAULT 50;
```

**Web UI**:
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≤ —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- Items Per Query (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 6)
- Scan Interval (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60 —Å–µ–∫—É–Ω–¥)

#### 3. –¢–æ–≤–∞—Ä—ã –±–µ–∑ —Ñ–æ—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–ª–∏—Å—å ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ —Å–∫–∞—á–∞–ª–æ—Å—å, —Ç–æ–≤–∞—Ä –Ω–µ –¥–æ–±–∞–≤–ª—è–ª—Å—è –≤ –ë–î

**–†–µ—à–µ–Ω–∏–µ**:
- –¢–æ–≤–∞—Ä—ã —Ç–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ë–î **–≤—Å–µ–≥–¥–∞**, –¥–∞–∂–µ –µ—Å–ª–∏ `image_data = NULL`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ: "Failed to download image, will add item without image data"
- –í –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `image_url` (high-res URL) –¥–∞–∂–µ –µ—Å–ª–∏ `image_data` –ø—É—Å—Ç

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`core.py`**:
   - `search_query()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `search.get('scan_limit')` –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤
   - `_process_new_items()` - —Ç–æ–≤–∞—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ —Ñ–æ—Ç–æ

2. **`db.py`**:
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `scan_limit` –≤ —Ç–∞–±–ª–∏—Ü—É `searches`
   - `add_search()` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `scan_limit`
   - `update_search()` - –æ–±–Ω–æ–≤–ª—è–µ—Ç `scan_limit` –∏ `scan_interval`

3. **`web_ui_plugin/app.py`**:
   - `/api/items` - —Å–∂–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
   - `/api/recent-items` - —Å–∂–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (300px)
   - `/api/queries/<id>` PUT - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç scan_limit –∏ scan_interval

4. **`web_ui_plugin/templates/queries.html`**:
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è Items Per Query –∏ Scan Interval
   - –§–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã

5. **`image_compressor.py`** ‚≠ê (–ù–û–í–´–ô):
   - –°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è Web UI
   - –£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –Ω–∞ 70-90%
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PIL/Pillow

6. **`requirements.txt`**:
   - –î–æ–±–∞–≤–ª–µ–Ω `Pillow>=10.0.0` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ø–µ—Ä—å

#### –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
```
Query 1: "Y-3 Shoes"
  - scan_limit: 6
  - scan_interval: 60 —Å–µ–∫—É–Ω–¥
  
Query 2: "Avangarde"
  - scan_limit: 50
  - scan_interval: 300 —Å–µ–∫—É–Ω–¥
```

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏!

#### –°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```
–û—Ä–∏–≥–∏–Ω–∞–ª –≤ –ë–î: 350KB (base64)
   ‚Üì
Web UI API (/api/items)
   ‚Üì
–°–∂–∞—Ç–∏–µ (400px, quality 75%)
   ‚Üì
Thumbnail: 45KB (base64)
   ‚Üì
–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã!
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ searches (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
```sql
CREATE TABLE searches (
    ...
    scan_interval INTEGER DEFAULT 300,  -- –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
    scan_limit INTEGER DEFAULT 50,      -- –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç ‚≠ê
    ...
);
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. ‚úÖ Web UI –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ (—Å–∂–∞—Ç—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
2. ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π limit (6, –∞ –Ω–µ 50)
3. ‚úÖ –¢–æ–≤–∞—Ä—ã –±–µ–∑ —Ñ–æ—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ë–î
4. ‚úÖ –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–∏ scan_limit –∏ scan_interval

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 19 –Ω–æ—è–±—Ä—è 2024, –≤–µ—á–µ—Ä
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é ‚úÖ
